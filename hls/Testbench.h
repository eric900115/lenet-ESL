#ifndef TESTBENCH_H_
#define TESTBENCH_H_

#include <string>
using namespace std;

#include <systemc>
using namespace sc_core;

#ifndef NATIVE_SYSTEMC
#include <cynw_p2p.h>
#endif

#include "filter_def.h"

#define WHITE 255
#define BLACK 0
#define THRESHOLD 90

class Testbench : public sc_module {
public:
	sc_in_clk i_clk;
	sc_out < bool >  o_rst;
#ifndef NATIVE_SYSTEMC
  cynw_p2p< sc_dt::sc_int<32> >::base_out o_img;
	cynw_p2p< sc_dt::sc_int<32> >::base_in i_result;
#else
  sc_fifo_out< sc_dt::sc_int<32> > o_img;
	sc_fifo_in< sc_dt::sc_int<32> > i_result;
#endif

  SC_HAS_PROCESS(Testbench);

  Testbench(sc_module_name n);
  ~Testbench();

private:
	unsigned int n_txn;
	sc_time max_txn_time;
	sc_time min_txn_time;
	sc_time total_txn_time;
	sc_time total_start_time;
	sc_time total_run_time;

  void feed_img();
	void fetch_result();

  sc_dt::sc_int<8> input_img[32*32] = {
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -126,  -121,  -116,  -117,  -117,  -121,  -124,  -125,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -112,   -43,    40,    26,    16,   -33,   -80,  -104,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,   -90,    71,   110,   109,   107,    97,    83,    62,    33,    33,    33,    33,    33,    33,    33,    33,    29,     4,   -79,  -119,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -105,    -9,    27,     6,    21,    49,    81,   105,   105,    90,   107,   109,   109,   107,   100,    97,   107,    93,    -7,  -106,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -121,   -96,   -78,   -92,   -83,   -65,   -39,    -6,    12,   -18,    18,    21,    21,    18,     1,    25,   118,   118,     1,  -104,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -123,  -109,   -95,  -117,   -91,   -89,   -89,   -92,   -88,   -18,   114,    96,   -49,  -114,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -123,   -67,    41,   110,    32,  -105,  -125,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -104,     0,   114,    91,   -56,  -122,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -124,   -48,    60,   118,    65,   -89,  -124,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -89,    32,   119,    69,   -67,  -124,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -45,    66,   102,    14,  -114,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -122,     0,    92,    56,   -59,  -126,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -67,    55,    93,     2,  -109,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -125,   -96,    25,    99,    52,   -56,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -126,  -114,   -14,    99,   100,   -10,  -105,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -116,   -62,    88,   116,    47,   -65,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -125,   -84,    81,   123,    91,   -38,  -113,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -116,   -50,   123,   126,   -10,   -99,  -126,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -116,   -51,    74,   119,    20,   -88,  -122,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -83,    18,   119,   114,   -44,  -113,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -108,   -23,    85,   126,   113,   -62,  -117,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -78,    29,   122,   123,    99,   -68,  -118,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -59,    51,   121,    96,    20,   -92,  -121,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,   -72,    17,    66,    12,  -113,  -126,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127, 
    -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127,  -127};
  };

#endif
